<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>CodePen - 현장체험학습 가이드북</title>
  

</head>
<body>
<!-- partial:index.partial.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>현장체험학습 가이드북</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.1.2/dist/tailwind.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&display=swap');

        body {
            background: linear-gradient(135deg, #E0F7FA 0%, #E8EAF6 100%);
            font-family: 'Jua', sans-serif;
            font-size: 18px;
            line-height: 1.6;
            touch-action: manipulation;
            min-height: 100vh;
            padding-bottom: 2rem;
            color: #2C3E50;
        }

        .section-header {
            background: linear-gradient(135deg, #4FC3F7 0%, #B3E5FC 100%);
            border: 3px solid #03A9F4;
            border-radius: 15px;
        }

        input, textarea, button {
            font-family: 'Jua', sans-serif;
            font-size: 1.1rem !important;
        }

        .card {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border: 2px solid #03A9F4;
            margin-bottom: 20px;
            padding: 20px;
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .cool-button {
            background: linear-gradient(135deg, #03A9F4 0%, #4FC3F7 100%);
            border: 2px solid #0288D1;
            border-radius: 12px;
            padding: 12px 24px;
            color: white;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            font-size: 1.1rem;
        }

        .cool-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #0288D1 0%, #03A9F4 100%);
        }

        .cool-input {
            border: 2px solid #03A9F4;
            border-radius: 12px;
            padding: 12px 16px;
            background-color: rgba(255, 255, 255, 0.9);
            font-size: 1.1rem;
            width: 100%;
            transition: all 0.3s;
        }

        .cool-input:focus {
            border-color: #0288D1;
            outline: none;
            box-shadow: 0 0 0 3px rgba(3,169,244,0.3);
            transform: translateY(-1px);
        }

        .problem-input-group {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            border: 2px solid #03A9F4;
            padding: 16px;
            margin-bottom: 16px;
        }

        .editor-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            background: #E3F2FD;
            padding: 12px;
            border-radius: 12px 12px 0 0;
            border: 2px solid #03A9F4;
            border-bottom: none;
        }

        .editor-button {
            background: white;
            border: 1px solid #03A9F4;
            border-radius: 6px;
            padding: 8px 12px;
            min-width: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            color: #0288D1;
        }

        .editor-button:hover {
            background: #E1F5FE;
            transform: translateY(-1px);
        }

        .editor-select {
            padding: 8px;
            border: 1px solid #03A9F4;
            border-radius: 6px;
            background: white;
            font-size: 1rem;
            color: #0288D1;
            cursor: pointer;
        }

        .editor-select:hover {
            background: #E1F5FE;
        }

        .color-picker {
            width: 35px;
            height: 35px;
            padding: 0;
            border: 2px solid #03A9F4;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .color-picker:hover {
            transform: scale(1.1);
        }

        #editor {
            border: 2px solid #03A9F4;
            border-radius: 0 0 12px 12px;
            min-height: 200px;
            padding: 16px;
            background: white;
            font-size: 1.1rem;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            position: relative;
            background-color: white;
            margin: 5% auto;
            padding: 24px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            border-radius: 15px;
            border: 3px solid #03A9F4;
            font-size: 1.1rem;
        }

        .close-button {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #03A9F4;
            transition: all 0.2s;
        }

        .close-button:hover {
            color: #0288D1;
            transform: scale(1.1);
        }

        /* 글자 크기 및 스타일 */
        h1 {
            font-size: 2.5rem !important;
            line-height: 1.2;
            color: #0288D1;
        }

        h2 {
            font-size: 2rem !important;
            line-height: 1.3;
            color: #0288D1;
        }

        h3 {
            font-size: 1.75rem !important;
            line-height: 1.4;
            color: #03A9F4;
        }

        p, li {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #2C3E50;
        }

        .text-lg {
            font-size: 1.25rem !important;
        }

        .text-xl {
            font-size: 1.5rem !important;
        }

        @media (max-width: 640px) {
            body {
                font-size: 16px;
            }

            h1 {
                font-size: 2rem !important;
            }

            h2 {
                font-size: 1.75rem !important;
            }

            h3 {
                font-size: 1.5rem !important;
            }

            p, li {
                font-size: 1rem;
            }

            .cool-button {
                padding: 10px 20px;
                font-size: 1rem;
            }

            .cool-input {
                padding: 10px 14px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <!-- Header -->
    <header class="text-center mb-8">
        <h1 class="font-bold text-blue-700 mb-4">
            🌊 현장체험학습 가이드북
        </h1>
        <p class="text-xl text-blue-600">함께 배우며 체험해요!</p>
    </header>

    <!-- 모드 전환 버튼 -->
    <div class="flex justify-center gap-4 mb-6">
        <button id="teacherModeBtn" 
                onclick="enableTeacherMode()" 
                class="cool-button">
            👩‍🏫 교사 모드로 전환
        </button>
        <button id="studentModeBtn" 
                onclick="enableStudentMode()" 
                class="cool-button bg-green-500" 
                style="display: none;">
            👨‍🎓 학생 모드로 전환
        </button>
    </div>

    <!-- 교사 전용 섹션 -->
    <section id="teacherSection" class="section-header p-6 rounded-lg shadow-md mb-6" style="display: none;">
        <h2 class="text-2xl font-bold mb-4">✏️ 현장체험학습 정보 입력</h2>
        
        <div class="space-y-4 mb-6">
            <div class="flex flex-col">
                <label for="dateInput" class="text-lg mb-2">📅 날짜</label>
                <input id="dateInput" type="date" 
                       class="cool-input" 
                       placeholder="날짜 선택">
            </div>
            
            <div class="flex flex-col">
                <label for="placeInput" class="text-lg mb-2">🏫 장소</label>
                <input id="placeInput" type="text" 
                       class="cool-input" 
                       placeholder="현장체험학습 장소를 입력하세요">
            </div>

            <div class="flex flex-col">
                <label class="text-lg mb-2">📝 안내사항</label>
                <div id="editor-container"></div>
            </div>
        </div>

        <div class="mb-6">
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-lg font-bold">📸 사진</h3>
                <button onclick="addMediaLink('photos')" 
                        class="cool-button">
                    사진 추가하기
                </button>
            </div>
            <div id="photosLinks" class="space-y-3"></div>
        </div>

        <div class="mb-6">
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-lg font-bold">🔗 참고 사이트</h3>
                <button onclick="addWebsiteLink()" 
                        class="cool-button">
                    링크 추가하기
                </button>
            </div>
            <div id="websiteLinks" class="space-y-3"></div>
        </div>

        <div class="mb-6">
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-lg font-bold">❓ 현장체험학습을 하면서 해결해 보아요.</h3>
                <button onclick="addProblem()" 
                        class="cool-button">
                    문제 추가하기
                </button>
            </div>
            <div id="problemsContainer" class="space-y-3"></div>
        </div>

        <button onclick="saveSchedule()" 
                class="cool-button w-full">
            💾 저장하기
        </button>
    </section>

    <!-- 학생 정보 입력 섹션 -->
    <section id="studentSection" class="card bg-blue-50 p-6 mb-6">
        <h2 class="text-2xl font-bold text-blue-700 mb-4">👋 안녕하세요!</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="flex flex-col">
                <label for="gradeInput" class="text-lg mb-2">학년</label>
                <input id="gradeInput" type="number" 
                       class="cool-input" 
                       placeholder="학년을 입력하세요">
            </div>
            <div class="flex flex-col">
                <label for="classInput" class="text-lg mb-2">반</label>
                <input id="classInput" type="number" 
                       class="cool-input" 
                       placeholder="반을 입력하세요">
            </div>
            <div class="flex flex-col">
                <label for="nameInput" class="text-lg mb-2">이름</label>
                <input id="nameInput" type="text" 
                       class="cool-input" 
                       placeholder="이름을 입력하세요">
            </div>
        </div>
    </section>

    <!-- 저장된 일정 목록 -->
    <section class="card mb-6">
        <h2 class="text-2xl font-bold text-blue-700 mb-4">📚 현장체험학습 가이드</h2>
        <div id="scheduleList" class="space-y-4"></div>
    </section>

    <!-- 학습 문제 섹션 -->
    <section id="problemSection" class="card" style="display: none;">
    </section>

    <!-- 제출된 학생 목록 -->
    <section id="submissionsList" class="card" style="display: none;">
    </section>

    <!-- 초기화 버튼 -->
    <section class="text-center">
        <button id="resetButton" 
                onclick="resetData()" 
                class="cool-button bg-red-500" 
                style="display: none;">
            🗑️ 초기화
        </button>
    </section>

    <!-- 모달 -->
    <div id="submissionModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeSubmissionModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // 전역 변수
        let teacherMode = false;
        let scheduleData = JSON.parse(localStorage.getItem('scheduleData')) || [];
        let studentSubmissions = JSON.parse(localStorage.getItem('studentSubmissions')) || [];

        // localStorage 저장 함수
        function saveToLocalStorage() {
            localStorage.setItem('scheduleData', JSON.stringify(scheduleData));
            localStorage.setItem('studentSubmissions', JSON.stringify(studentSubmissions));
        }

        // WYSIWYG 에디터 초기화
        function initWysiwygEditor() {
            const container = document.getElementById('editor-container');
            container.innerHTML = `
                <div class="wysiwyg-container">
                    <div class="editor-toolbar">
                        <!-- 글자 스타일 -->
                        <select class="editor-select" data-command="formatBlock">
                            <option value="p">기본 글자</option>
                            <option value="h1">제목 1</option>
                            <option value="h2">제목 2</option>
                            <option value="h3">제목 3</option>
                        </select>

                        <!-- 글자 크기 -->
                        <select class="editor-select" data-command="fontSize">
                            <option value="2">작게</option>
                            <option value="3" selected>보통</option>
                            <option value="4">크게</option>
                            <option value="5">더 크게</option>
                            <option value="6">매우 크게</option>
                        </select>

                        <!-- 글자색 -->
                        <input type="color" class="color-picker" data-command="foreColor" title="글자색" value="#2C3E50">
                        
                        <!-- 배경색 -->
                        <input type="color" class="color-picker" data-command="backColor" title="배경색" value="#FFFFFF">

                        <!-- 글자 스타일 버튼들 -->
                        <button type="button" class="editor-button" data-command="bold" title="굵게">
                            <strong>굵게</strong>
                        </button>
                        <button type="button" class="editor-button" data-command="italic" title="기울임">
                            <em>기울임</em>
                        </button>
                        <button type="button" class="editor-button" data-command="underline" title="밑줄">
                            <u>밑줄</u>
                        </button>
                        <button type="button" class="editor-button" data-command="strikeThrough" title="취소선">
                            <s>취소선</s>
                        </button>

                        <!-- 정렬 -->
                        <button type="button" class="editor-button" data-command="justifyLeft" title="왼쪽 정렬">
                            왼쪽
                        </button>
                        <button type="button" class="editor-button" data-command="justifyCenter" title="가운데 정렬">
                            가운데
                        </button>
                        <button type="button" class="editor-button" data-command="justifyRight" title="오른쪽 정렬">
                            오른쪽
                        </button>

                        <!-- 목록 -->
                        <button type="button" class="editor-button" data-command="insertUnorderedList" title="기호 목록">
                            기호목록
                        </button>
                        <button type="button" class="editor-button" data-command="insertOrderedList" title="번호 목록">
                            번호목록
                        </button>
                        
                        <!-- 들여쓰기 -->
                        <button type="button" class="editor-button" data-command="indent" title="들여쓰기">
                            들여쓰기
                        </button>
                        <button type="button" class="editor-button" data-command="outdent" title="내어쓰기">
                            내어쓰기
                        </button>
                    </div>
                    <div id="editor" contenteditable="true" class="p-4 min-h-[200px]"></div>
                </div>
            `;

            const editor = document.getElementById('editor');
            const buttons = document.querySelectorAll('.editor-button');
            const selects = document.querySelectorAll('.editor-select');
            const colorPickers = document.querySelectorAll('.color-picker');

            // 버튼 이벤트
            buttons.forEach(button => {
                button.addEventListener('click', () => {
                    const command = button.dataset.command;
                    document.execCommand(command, false, null);
                    editor.focus();
                });
            });

            // 선택 메뉴 이벤트
            selects.forEach(select => {
                select.addEventListener('change', () => {
                    const command = select.dataset.command;
                    document.execCommand(command, false, select.value);
                    editor.focus();
                });
            });

            // 컬러피커 이벤트
            colorPickers.forEach(picker => {
                picker.addEventListener('change', () => {
                    const command = picker.dataset.command;
                    document.execCommand(command, false, picker.value);
                    editor.focus();
                });
            });

            // 에디터 포커스 효과
            editor.addEventListener('focus', () => {
                editor.style.boxShadow = '0 0 0 3px rgba(3,169,244,0.3)';
            });

            editor.addEventListener('blur', () => {
                editor.style.boxShadow = 'none';
            });
        }

        // 교사 모드 전환
        function enableTeacherMode() {
            const password = prompt("선생님 비밀번호를 입력해주세요:");
            if (password === "1234") {
                teacherMode = true;
                toggleMode();
                alert("교사 모드가 시작되었어요! 🎉");
            } else {
                alert("비밀번호가 틀렸어요! 다시 시도해주세요. 😊");
            }
        }

        // 학생 모드 전환
        function enableStudentMode() {
            teacherMode = false;
            toggleMode();
            alert("학생 모드로 돌아왔어요! 📚");
        }

        // 모드 전환 시 화면 업데이트
        function toggleMode() {
            document.getElementById("resetButton").style.display = teacherMode ? "block" : "none";
            document.getElementById("teacherSection").style.display = teacherMode ? "block" : "none";
            document.getElementById("studentSection").style.display = !teacherMode ? "block" : "none";
            document.getElementById("submissionsList").style.display = teacherMode ? "block" : "none";
            document.getElementById("studentModeBtn").style.display = teacherMode ? "block" : "none";
            document.getElementById("teacherModeBtn").style.display = teacherMode ? "none" : "block";
            document.getElementById("problemSection").style.display = !teacherMode ? "block" : "none";
            displaySchedules();
            if (teacherMode) {
                displaySubmissions();
            }
        }

        // 웹페이지 링크 추가
        function addWebsiteLink() {
            const container = document.getElementById('websiteLinks');
            const wrapper = document.createElement('div');
            wrapper.className = 'flex flex-wrap items-center gap-2 mb-2 p-2 bg-blue-50 rounded-lg';
            
            const urlInput = document.createElement('input');
            urlInput.type = 'text';
            urlInput.className = 'cool-input flex-1';
            urlInput.placeholder = '🔗 웹페이지 주소를 입력하세요';
            
            const descInput = document.createElement('input');
            descInput.type = 'text';
            descInput.className = 'cool-input flex-1';
            descInput.placeholder = '📝 설명을 입력하세요';
            
            const deleteBtn = document.createElement('button');
            deleteBtn.type = 'button';
            deleteBtn.className = 'cool-button bg-red-500 text-white';
            deleteBtn.innerHTML = '🗑️ 삭제';
            deleteBtn.onclick = function() {
                wrapper.remove();
            };
            
            wrapper.appendChild(urlInput);
            wrapper.appendChild(descInput);
            wrapper.appendChild(deleteBtn);
            container.appendChild(wrapper);
        }

        // 사진 링크 추가
        function addMediaLink(type) {
            if (type === 'photos') {
                const container = document.getElementById('photosLinks');
                const wrapper = document.createElement('div');
                wrapper.className = 'flex flex-wrap items-center gap-2 mb-2 p-2 bg-blue-50 rounded-lg';
                
                const urlInput = document.createElement('input');
                urlInput.type = 'text';
                urlInput.className = 'cool-input flex-1';
                urlInput.placeholder = '📸 사진 주소를 입력하세요';
                
                const deleteBtn = document.createElement('button');
                deleteBtn.type = 'button';
                deleteBtn.className = 'cool-button bg-red-500 text-white';
                deleteBtn.innerHTML = '🗑️ 삭제';
                deleteBtn.onclick = function() {
                    wrapper.remove();
                };
                
                wrapper.appendChild(urlInput);
                wrapper.appendChild(deleteBtn);
                container.appendChild(wrapper);
            }
        }

        // 문제 추가
        function addProblem() {
            const container = document.getElementById('problemsContainer');
            const problemDiv = document.createElement('div');
            problemDiv.className = 'problem-input-group';
            problemDiv.innerHTML = `
                <div class="flex items-center gap-2">
                    <textarea class="cool-input flex-1" 
                             placeholder="✏️ 문제를 입력하세요" rows="3"></textarea>
                    <button type="button" onclick="removeProblem(this)" 
                            class="cool-button bg-red-500">🗑️ 삭제</button>
                </div>
            `;
            container.appendChild(problemDiv);
        }

        // 문제 삭제
        function removeProblem(button) {
            button.closest('.problem-input-group').remove();
        }

// 일정 표시
        function displaySchedules() {
            const scheduleList = document.getElementById("scheduleList");
            const problemSection = document.getElementById("problemSection");
            
            scheduleList.innerHTML = "";
            problemSection.innerHTML = "<h2 class='text-2xl font-bold text-blue-700 mb-4'>✏️ 문제를 해결해 보세요</h2>";
            
            problemSection.style.display = !teacherMode ? "block" : "none";

            scheduleData.forEach((schedule) => {
                const scheduleItem = document.createElement("div");
                scheduleItem.className = 'card';

                const photosHTML = schedule.photoLinks.length > 0 
                    ? `<div class="mt-4">
                        <strong>📸 사진:</strong><br>
                        ${schedule.photoLinks.map(link => 
                            `<img src="${link}" alt="현장체험학습 사진" 
                                  class="w-full max-w-lg mx-auto my-2 rounded-lg shadow-md">`
                        ).join('')}
                       </div>` 
                    : '';

                const websitesHTML = schedule.websiteLinks.length > 0
                    ? `<div class="mt-4">
                        <strong>🔗 참고자료:</strong><br>
                        ${schedule.websiteLinks.map(link => `
                            <div class="mb-2">
                                <a href="${link.url}" target="_blank" rel="noopener noreferrer" 
                                   class="text-blue-600 hover:text-blue-800 hover:underline flex items-center gap-2">
                                   📎 ${link.description || link.url}
                                </a>
                            </div>
                        `).join('')}
                       </div>`
                    : '';

                scheduleItem.innerHTML = `
                    <h3 class="text-2xl font-bold text-blue-600 mb-3">🏫 ${schedule.place}</h3>
                    <p class="mb-3"><strong>📅 날짜:</strong> ${schedule.date}</p>
                    <div class="mb-4">
                        <strong>ℹ️ 안내사항:</strong><br>
                        <div class="mt-2 p-3 bg-blue-50 rounded-lg">${schedule.info}</div>
                    </div>
                    ${photosHTML}
                    ${websitesHTML}
                `;

                scheduleList.appendChild(scheduleItem);

                if (!teacherMode) {
                    const problemItem = document.createElement("div");
                    problemItem.className = 'card';
                    
                    if (schedule.problems && schedule.problems.length > 0) {
                        problemItem.innerHTML = `
                            <h4 class="text-xl font-bold text-blue-600 mb-4">📝 ${schedule.place} 질문</h4>
                            ${schedule.problems.map((problem, pIndex) => `
                                <div class="mb-4 p-4 bg-blue-50 rounded-lg">
                                    <p class="font-medium mb-3 text-lg">${pIndex + 1}. ${problem}</p>
                                    <textarea
                                        id="answer_${schedule.id}_${pIndex}"
                                        class="cool-input w-full"
                                        placeholder="이곳에 답변을 적어주세요..."
                                        rows="3"
                                    ></textarea>
                                </div>
                            `).join('')}
                            <button
                                onclick="submitAnswers(${schedule.id})"
                                class="cool-button w-full mt-4"
                            >
                                📮 답변 제출하기
                            </button>
                        `;
                        
                        problemSection.appendChild(problemItem);
                    }
                }
            });
        }

        // 제출된 답변 표시
        function displaySubmissions() {
            if (!teacherMode) return;
            
            const submissionsList = document.getElementById("submissionsList");
            submissionsList.innerHTML = "<h2 class='text-2xl font-bold text-blue-700 mb-4'>📋 제출된 답변 목록</h2>";

            const studentsByClass = {};
            const submissionsByStudent = {};

            studentSubmissions.forEach((submission) => {
                const classKey = `${submission.grade}학년 ${submission.className}반`;
                const studentKey = `${classKey}_${submission.name}`;
                
                if (!studentsByClass[classKey]) {
                    studentsByClass[classKey] = new Set();
                }
                studentsByClass[classKey].add(submission.name);
                
                if (!submissionsByStudent[studentKey] || 
                    new Date(submission.timestamp) > new Date(submissionsByStudent[studentKey].timestamp)) {
                    submissionsByStudent[studentKey] = submission;
                }
            });

            Object.entries(studentsByClass).forEach(([classKey, students]) => {
                const classItem = document.createElement("div");
                classItem.className = 'card';
                
                const studentsList = Array.from(students).sort();
                
                const studentButtons = studentsList.map(name => {
                    const studentKey = `${classKey}_${name}`;
                    const submission = submissionsByStudent[studentKey];
                    return `
                        <button
                            onclick='openSubmissionModal(${JSON.stringify(submission)})'
                            class="cool-button bg-blue-100 text-blue-800 hover:bg-blue-200"
                        >
                            👤 ${name}
                            <span class="text-xs block text-gray-600">
                                ${new Date(submission.timestamp).toLocaleString('ko-KR', {
                                    month: 'short',
                                    day: 'numeric',
                                    hour: '2-digit',
                                    minute: '2-digit'
                                })}
                            </span>
                        </button>
                    `;
                }).join('');
                
                classItem.innerHTML = `
                    <div class="font-bold text-xl text-blue-600 mb-3">📚 ${classKey}</div>
                    <div class="flex flex-wrap gap-2">
                        ${studentButtons}
                    </div>
                `;
                
                submissionsList.appendChild(classItem);
            });
        }
 // 일정 저장
        function saveSchedule() {
            if (!teacherMode) {
                alert("선생님 모드에서만 저장할 수 있어요! 👩‍🏫");
                return;
            }

            const date = document.getElementById("dateInput").value;
            const place = document.getElementById("placeInput").value;
            const info = document.getElementById("editor").innerHTML;

            const photoLinks = Array.from(document.querySelectorAll('#photosLinks input[type="text"]'))
                .map(input => input.value.trim())
                .filter(Boolean);

            const websiteLinks = [];
            const websiteDivs = document.querySelectorAll('#websiteLinks > div');
            websiteDivs.forEach(div => {
                const inputs = div.querySelectorAll('input[type="text"]');
                if (inputs[0] && inputs[0].value.trim()) {
                    websiteLinks.push({
                        url: inputs[0].value.trim(),
                        description: inputs[1] ? inputs[1].value.trim() : ''
                    });
                }
            });

            const problems = Array.from(document.querySelectorAll('#problemsContainer textarea'))
                .map(textarea => textarea.value.trim())
                .filter(Boolean);

            if (!date || !place || !info || problems.length === 0) {
                alert("모든 필수 항목을 입력해주세요! ✏️");
                return;
            }

            scheduleData.push({
                id: Date.now(),
                date,
                place,
                info,
                photoLinks,
                websiteLinks,
                problems
            });

            saveToLocalStorage();
            alert("안내자료가 저장되었어요! 🎉");
            displaySchedules();
            clearInputs();
        }

        // 답변 제출
        function submitAnswers(scheduleId) {
            const grade = document.getElementById("gradeInput").value;
            const className = document.getElementById("classInput").value;
            const name = document.getElementById("nameInput").value;
            const answers = {};
            
            const schedule = scheduleData.find(s => s.id === scheduleId);
            let allAnswered = true;
            
            schedule.problems.forEach((_, index) => {
                const answer = document.getElementById(`answer_${scheduleId}_${index}`).value;
                if (!answer) {
                    allAnswered = false;
                }
                answers[index] = answer;
            });

            if (!allAnswered) {
                alert("모든 질문에 답해주세요! ✏️");
                return;
            }
            if (grade && className && name) {
                studentSubmissions.push({
                    scheduleId,
                    grade,
                    className,
                    name,
                    answers,
                    timestamp: new Date().toLocaleString()
                });

                saveToLocalStorage();
                alert("답변이 잘 제출되었어요! 👏");
                displaySubmissions();
                
                // 입력 필드 초기화
                document.getElementById("gradeInput").value = "";
                document.getElementById("classInput").value = "";
                document.getElementById("nameInput").value = "";
                schedule.problems.forEach((_, index) => {
                    document.getElementById(`answer_${scheduleId}_${index}`).value = "";
                });
            } else {
                alert("학년, 반, 이름을 모두 입력해주세요! 📝");
            }
        }

        // 모달 관련 함수
        function openSubmissionModal(submission) {
            const modal = document.getElementById('submissionModal');
            const modalContent = document.getElementById('modalContent');
            const schedule = scheduleData.find(s => s.id === submission.scheduleId);

            if (!schedule) return;

            modalContent.innerHTML = `
                <h2 class="text-2xl font-bold mb-4">📝 답변 확인</h2>
                <div class="bg-blue-50 p-4 rounded-lg mb-4">
                    <p class="text-lg mb-2">
                        <strong>👤 ${submission.grade}학년 ${submission.className}반 ${submission.name}</strong>
                    </p>
                    <p class="text-gray-600">⏰ 제출시간: ${submission.timestamp}</p>
                    <p class="text-lg mt-2"><strong>🏫 장소:</strong> ${schedule.place}</p>
                </div>
                <div class="space-y-4">
                    ${Object.entries(submission.answers).map(([index, answer]) => `
                        <div class="border-b pb-4">
                            <p class="font-medium text-blue-600 mb-2">❓ ${schedule.problems[index]}</p>
                            <p class="mt-2 ml-4 p-3 bg-gray-50 rounded-lg">${answer}</p>
                        </div>
                    `).join('')}
                </div>
            `;

            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // 모달 닫기
        function closeSubmissionModal() {
            const modal = document.getElementById('submissionModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 데이터 초기화
        function resetData() {
            if (teacherMode) {
                const confirmReset = confirm("정말 모든 데이터를 초기화할까요? 🤔");
                if (confirmReset) {
                    scheduleData = [];
                    studentSubmissions = [];
                    localStorage.removeItem('scheduleData');
                    localStorage.removeItem('studentSubmissions');
                    displaySchedules();
                    displaySubmissions();
                    alert("모든 데이터가 초기화되었어요! 🧹");
                }
            } else {
                alert("선생님만 초기화할 수 있어요! 👩‍🏫");
            }
        }

        // 입력 필드 초기화
        function clearInputs() {
            document.getElementById("dateInput").value = "";
            document.getElementById("placeInput").value = "";
            document.getElementById("editor").innerHTML = "";
            document.getElementById("photosLinks").innerHTML = "";
            document.getElementById("websiteLinks").innerHTML = "";
            document.getElementById("problemsContainer").innerHTML = "";
        }

        // ESC 키로 모달 닫기
        window.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeSubmissionModal();
            }
        });

        // 모달 외부 클릭 시 닫기
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('submissionModal');
            if (event.target === modal) {
                closeSubmissionModal();
            }
        });

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            initWysiwygEditor();
            displaySchedules();
            displaySubmissions();
            document.getElementById("problemSection").style.display = !teacherMode ? "block" : "none";
        });
    </script>
</body>
</html>
<!-- partial -->
  
</body>
</html>
